{% extends "base.html" %}

{% block title %}{{ page.title }} - {{ config.title }}{% endblock title %}

{% block description %}{% if page.description %}{{ page.description }}{% else %}{{ config.description }}{% endif %}{% endblock description %}

{% block content %}
<article>
    <header class="post-header">
        <h1>{{ page.title }}</h1>
        {% if page.date %}<time datetime="{{ page.date }}">{{ page.date | date(format="%B %d, %Y") }}</time>{% endif %}
    </header>
    <div class="content">
        {% if page.content is containing("<!--TOC_PLACEHOLDER-->") %}
            {% set parts = page.content | split(pat="<!--TOC_PLACEHOLDER-->") %}
            {{ parts[0] | safe }}
            <nav class="toc">
                <p class="toc-title">Table of Contents</p>
                <ul>
                {% for h2 in page.toc %}
                    <li>
                        <a href="{{ h2.permalink | safe }}">{{ h2.title }}</a>
                        {% if h2.children %}
                        <ul>
                            {% for h3 in h2.children %}
                            <li><a href="{{ h3.permalink | safe }}">{{ h3.title }}</a></li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </li>
                {% endfor %}
                </ul>
            </nav>
            {{ parts[1] | safe }}
        {% else %}
            {{ page.content | safe }}
        {% endif %}
    </div>
</article>
{% endblock content %}
